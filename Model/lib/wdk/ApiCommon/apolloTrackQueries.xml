<wdkModel>

  <querySet name="ApolloTables" queryType="table" isCacheable="true">

    <sqlQuery name="Apollo">
      <column name="source_id"/>
      <column name="apollo_transcript_id"/>
      <column name="apollo_description"/>
      <column name="apollo_owner"/>
      <column name="apollo_dbxref"/>
      <column name="apollo_symbol"/>
      <column name="apollo_go_term"/>

      <sql>
        <![CDATA[
    select ga.source_id
                , cast(utl_url.unescape(replace( replace(regexp_substr(au.attr, 'Name=[^;]*;'), 'Name=', ''), ';', '')) as varchar2(400)) as apollo_transcript_id
                , apolloproduct as apollo_description
                , apolloowner as apollo_owner
                , apollopmid as apollo_dbxref
                , apollosymbol as apollo_symbol
                , apollogoterm as apollo_go_term
from  apidbtuning.ApolloUpdate au, ApidbTuning.GeneAttributes ga
     where au.type = 'gene'
     and (au.attr like '%gene_product=%'
          or au.attr like '%description=%')
     and ga.na_sequence_id = au.na_sequence_id
     and ga.start_min <= au.mapping_end 
     and ga.end_max >= au.mapping_start
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="ApolloCommentIDs">
      <column name="source_id"/>
      <column name="id_attr"/>
      <sql>
        <![CDATA[
    select distinct ga.source_id
                ,id_attr
from  apidbtuning.ApolloUpdate au, ApidbTuning.GeneAttributes ga
     where au.type = 'gene'
     and (au.attr like '%gene_product=%'
          or au.attr like '%description=%')
     and ga.na_sequence_id = au.na_sequence_id
     and ga.start_min <= au.mapping_end 
     and ga.end_max >= au.mapping_start
        ]]>
      </sql>
    </sqlQuery>

  </querySet>

</wdkModel>
